<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
    
    <!-- empty database -->
    <changeSet author="Carol Geisler" id="master_01">
    	<tagDatabase tag="00_EmptyDB"/>
    </changeSet>
    
    <!-- deployment tag - not used, yet. Need to fully understand implications and limitations -->
    <!--changeSet author="Carol Geisler" id="deployment_tag_${RELEASE_TAG}" runAlways="true">
    	<tagDatabase tag="${RELEASE_TAG}"/>
    </changeSet-->
    
    <!-- create roles, schemas, and other db env prereqs -->
    <include file="shersched.db.changelog-db.env.xml"/>
    
    <!-- create database -->
    <include file="shersched.db.changelog-ddl.00.xml"/>
    
    <!-- add required data -->
    <include file="shersched.db.changelog-basedata.xml"/>
    
    <!-- dev data - all changeSets have context "dev" -->
    <include file="dev/shersched.db.changelog-data.dev.xml"/>
    
    <!-- changes for assignment and duty_recurrence active -->
    <include file="shersched.db.changelog-ddl.01.xml"/>
    
    <!-- add shift -->
    <include file="shersched.db.changelog-ddl.02.xml"/>
    
    <!-- cleanup indexes, nullables -->
    <include file="shersched.db.changelog-ddl.03.xml"/>
    
    <!-- clean up dev data, if present -->
    <include file="dev/shersched.db.changelog-cleandev.xml"/>
    
    <!-- schema updates for Chilliwack release -->
    <include file="shersched.db.changelog-ddl.04.xml"/>
    
    <!-- schema updates for Leave support -->
    <include file="shersched.db.changelog-ddl.05.xml"/>
   
    <!-- schema updates for Assignment updates -->
    <include file="shersched.db.changelog-ddl.06.xml"/>
    
    <!-- schema updates for audit support  -->
    <include file="shersched.db.changelog-ddl.07.xml"/>
    
    <!-- schema updates for Gender -->
    <include file="shersched.db.changelog-ddl.08.xml"/>

    <!-- schema updates for Shift Assignment foreign key -->
    <include file="shersched.db.changelog-ddl.09.xml"/>

    <!-- schema updates for Justin IDs -->
    <include file="shersched.db.changelog-ddl.10.xml"/>
   
    <!-- load prod data -->
    <include file="data/shersched.db.changelog-data.prod.xml"/>
    
    <changeSet author="Carol Geisler" id="master_99" runAlways="true">
    	<!--tagDatabase tag="99_MasterLogCompleted"/-->
    	<!--empty/-->    		
    	  <sql>
    	  	  SET SEARCH_PATH = ${POSTGRES_SCHEMA}, ${POSTGRES_EXT_SCHEMA};
    	  </sql>
    	<rollback>
    	  <sql>
    	  	  SET SEARCH_PATH = ${POSTGRES_SCHEMA}, ${POSTGRES_EXT_SCHEMA};
    	  </sql>    		
    	</rollback>
    </changeSet>

    <!-- Use the changeSet below to cause Liquibase to exit at an arbitrary 
         point before completion -->
    <!--changeSet author="Carol Geisler" id="stop_exitMaster">
    	<stop/>
    </changeSet-->
    
</databaseChangeLog>